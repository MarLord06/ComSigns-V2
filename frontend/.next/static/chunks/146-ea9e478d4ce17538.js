"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[146],{2138:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(9946).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},2657:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(9946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2919:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(9946).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},3168:(e,r,t)=>{t.d(r,{N:()=>n});var o=t(5647);let s="https://xqdlbbwavnmkewvjaget.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhxZGxiYndhdm5ta2V3dmphZ2V0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwOTUxNjksImV4cCI6MjA2ODY3MTE2OX0.MRfDvIbM8zOEwTj6muzZTzeNwWoQ-TfjzExjMIabLs4";if(!s)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_URL");if(!a)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_ANON_KEY");let n=(0,o.UU)(s,a,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},3999:(e,r,t)=>{t.d(r,{Me:()=>n,cn:()=>a});var o=t(2596),s=t(9688);function a(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.QP)((0,o.$)(r))}function n(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"".concat(function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e.toFixed(r))}(t?e:100*e,r),"%")}(e,r,!1)}},6052:(e,r,t)=>{t.d(r,{A:()=>i,AuthProvider:()=>l});var o=t(5155),s=t(2115),a=t(3168);let n=(0,s.createContext)(void 0),i=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:r}=e,[t,i]=(0,s.useState)(null),[l,u]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[g,h]=(0,s.useState)(null),[f,p]=(0,s.useState)(!0),[v,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{console.log("Initializing auth..."),(async()=>{var e;let{data:{session:r},error:t}=await a.N.auth.getSession();if(t){console.error("Error getting session:",t),p(!1);return}console.log("Initial session:",r?"Found":"Not found"),u(r),i(null!==(e=null==r?void 0:r.user)&&void 0!==e?e:null),(null==r?void 0:r.user)&&(console.log("User found, loading profile and stats..."),await _(r.user.id),await y(r.user.id)),p(!1),console.log("Auth initialization complete")})();let{data:{subscription:e}}=a.N.auth.onAuthStateChange(async(e,r)=>{var t;console.log("Auth state changed:",e),u(r),i(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),(null==r?void 0:r.user)?(console.log("Loading user data..."),_(r.user.id),y(r.user.id),"SIGNED_IN"===e&&m(!0)):(d(null),h(null),m(!1)),p(!1)});return()=>{e.unsubscribe()}},[]);let _=async e=>{try{console.log("Loading profile for user:",e);let{data:r,error:t}=await a.N.from("user_profiles").select("*").eq("id",e).maybeSingle();if(t){console.error("Error loading profile:",t),("42P01"===t.code||t.message.includes("does not exist"))&&(console.log("Forcing logout due to profile error"),await a.N.auth.signOut());return}if(!r){console.log("No profile found for user, user might have been deleted"),await a.N.auth.signOut();return}console.log("Profile data:",r),d(r)}catch(e){console.error("Error loading profile:",e),await a.N.auth.signOut()}},y=async e=>{try{console.log("Loading stats for user:",e);let{data:r,error:t}=await a.N.from("game_attempts").select("points_earned, is_correct, time_taken_seconds").eq("user_id",e);if(t){console.log("No stats yet, using defaults:",t),h({total_sessions:0,total_practice_time:0,letters_completed:[],average_accuracy:0,current_streak:0,best_streak:0,total_points:0,level:1});return}if(console.log("Attempts data:",r),r&&r.length>0){let e=r.filter(e=>e.is_correct),t={total_sessions:r.length,total_practice_time:r.reduce((e,r)=>e+(r.time_taken_seconds||0),0),letters_completed:[],average_accuracy:e.length/r.length,current_streak:0,best_streak:0,total_points:r.reduce((e,r)=>e+(r.points_earned||0),0),level:Math.floor(r.reduce((e,r)=>e+(r.points_earned||0),0)/100)+1};h(t),console.log("Stats loaded successfully:",t)}else h({total_sessions:0,total_practice_time:0,letters_completed:[],average_accuracy:0,current_streak:0,best_streak:0,total_points:0,level:1}),console.log("Using default stats for new user")}catch(e){console.error("Error loading stats:",e),h({total_sessions:0,total_practice_time:0,letters_completed:[],average_accuracy:0,current_streak:0,best_streak:0,total_points:0,level:1})}},b=async(e,r)=>{try{var t;console.log("Attempting login for:",e);let{data:o,error:s}=await a.N.auth.signInWithPassword({email:e,password:r});if(s){if(console.error("Login error:",s),s.message.includes("Email not confirmed"))return console.error("Email needs confirmation"),{error:{...s,message:"Confirma tu email antes de iniciar sesi\xf3n"}};if(s.message.includes("Invalid login credentials"))return console.error("Invalid credentials"),{error:{...s,message:"Email o contrase\xf1a incorrectos"}};return{error:s}}return console.log("Login successful:",null===(t=o.user)||void 0===t?void 0:t.email),{error:null}}catch(e){return console.error("Unexpected login error:",e),{error:e}}},w=async(e,r,t,o,s)=>{try{let{data:n,error:i}=await a.N.auth.signUp({email:e,password:r,options:{data:{username:t,full_name:o,experience_level:s}}});if(i)return console.error("Auth signup error:",i),{error:i};if(!n.user)return console.error("No user data returned"),{error:Error("No user data returned")};let{error:l}=await a.N.from("user_profiles").insert({id:n.user.id,username:t,full_name:o,experience_level:s});if(l){if(console.error("Error creating profile:",l),"42P01"===l.code)return console.error("La tabla profiles no existe. Ejecuta el schema de Supabase."),{error:Error("Database not configured. Please contact support.")};return{error:l}}return console.log("User and profile created successfully"),{error:null}}catch(e){return console.error("Unexpected signup error:",e),{error:e}}},x=async()=>{let{error:e}=await a.N.auth.signOut();e&&console.error("Error signing out:",e)},k=async e=>{if(!t)return{error:Error("No user logged in")};try{let{error:r}=await a.N.from("user_profiles").update(e).eq("id",t.id);return r||d(r=>r?{...r,...e}:null),{error:r}}catch(e){return{error:e}}},N=async()=>{t&&await y(t.id)},E=async()=>{if(t)try{let{error:e}=await a.N.from("profiles").update({is_new_user:!1}).eq("id",t.id);e?console.error("Error completing tutorial:",e):d(e=>e?{...e,is_new_user:!1}:null)}catch(e){console.error("Error updating tutorial status:",e)}};return(0,o.jsx)(n.Provider,{value:{user:t,session:l,profile:c,stats:g,loading:f,signIn:b,signUp:w,signOut:x,updateProfile:k,refreshStats:N,isNewUser:v,completeTutorial:E},children:r})}},7168:(e,r,t)=>{t.d(r,{$:()=>l});var o=t(5155);t(2115);var s=t(9708),a=t(2085),n=t(3999);let i=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:r,variant:t,size:a,asChild:l=!1,...u}=e,c=l?s.DX:"button";return(0,o.jsx)(c,{"data-slot":"button",className:(0,n.cn)(i({variant:t,size:a,className:r})),...u})}},7550:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8749:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(9946).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},8883:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(9946).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])}}]);