(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[979],{1397:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});var a=s(5155);s(2115);var r=s(5863),n=s(3999);function i(e){let{className:t,value:s,...i}=e;return(0,a.jsx)(r.bL,{"data-slot":"progress",className:(0,n.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...i,children:(0,a.jsx)(r.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})}},1745:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var a=s(5155),r=s(2115),n=s(8482),i=s(4355);let l=(0,r.forwardRef)(function(e,t){let{isActive:s,onError:l,className:c,width:o=640,height:d=480}=e,u=(0,r.useRef)(null),h=(0,r.useRef)(null),m=(0,r.useRef)(null);return((0,r.useImperativeHandle)(t,()=>({captureFrame:async()=>{if(!u.current||!h.current)return null;let e=h.current,t=u.current,s=e.getContext("2d");return s?(e.width=t.videoWidth,e.height=t.videoHeight,s.drawImage(t,0,0),new Promise(t=>{e.toBlob(e=>{e?t(new File([e],"frame.jpg",{type:"image/jpeg"})):t(null)},"image/jpeg",.8)})):null},getVideoElement:()=>u.current})),(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{if(!s){m.current&&(m.current.getTracks().forEach(e=>e.stop()),m.current=null),u.current&&(u.current.srcObject=null);return}let t=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:o},height:{ideal:d},facingMode:"user"}});if(!e){t.getTracks().forEach(e=>e.stop());return}m.current=t,u.current&&(u.current.srcObject=t)}catch(e){console.error("Error accessing camera:",e),l&&l("Error accediendo a la c\xe1mara: ".concat(e instanceof Error?e.message:"Error desconocido"))}})(),()=>{e=!1,m.current&&m.current.getTracks().forEach(e=>e.stop())}},[s,o,d,l]),s)?(0,a.jsx)(n.Zp,{className:c,children:(0,a.jsx)(n.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("video",{ref:u,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-auto rounded-lg bg-black",style:{aspectRatio:"".concat(o,"/").concat(d)}}),(0,a.jsx)("canvas",{ref:h,className:"hidden"}),(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-1 bg-black/50 text-white px-2 py-1 rounded text-xs",children:[(0,a.jsx)("div",{className:"h-2 w-2 bg-red-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{children:"EN VIVO"})]})})]})})}):(0,a.jsx)(n.Zp,{className:c,children:(0,a.jsx)(n.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,a.jsx)(i.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"C\xe1mara desactivada"}),(0,a.jsx)("p",{className:"text-sm",children:"Activa la c\xe1mara para comenzar"})]})})})});var c=s(8145),o=s(1397),d=s(6813),u=s(4186);function h(e){let{result:t,isProcessing:s,className:r,currentPrediction:i="",confidence:l=0}=e;return s?(0,a.jsxs)(n.Zp,{className:r,children:[(0,a.jsx)(n.aR,{children:(0,a.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-primary border-t-transparent rounded-full"}),"Traduciendo en tiempo real..."]})}),(0,a.jsx)(n.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl font-bold text-primary mb-2",children:i||"?"}),l>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Confianza:"}),(0,a.jsxs)("span",{className:"font-medium",children:[(100*l).toFixed(1),"%"]})]}),(0,a.jsx)(o.k,{value:100*l,className:"w-full"})]})]})})]}):t||s?t?(0,a.jsxs)(n.Zp,{className:r,children:[(0,a.jsx)(n.aR,{children:(0,a.jsxs)(n.ZB,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Resultado de Traducci\xf3n"}),t.success?(0,a.jsx)(c.E,{variant:"default",className:"bg-green-100 text-green-800",children:"\xc9xito"}):(0,a.jsx)(c.E,{variant:"destructive",children:"Sin detecci\xf3n"})]})}),(0,a.jsx)(n.Wu,{className:"space-y-4",children:t.success&&t.result?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl font-bold text-primary mb-2",children:t.result.text||"?"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Texto detectado"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Confianza"}),(0,a.jsxs)("span",{children:[(100*t.result.confidence).toFixed(1),"%"]})]}),(0,a.jsx)(o.k,{value:100*t.result.confidence,className:"h-2"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("span",{children:[t.result.processing_time_ms,"ms"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("span",{children:[t.result.signs_detected," se\xf1al(es)"]})]})]}),t.result.detailed_predictions&&t.result.detailed_predictions.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Predicciones detalladas:"}),(0,a.jsx)("div",{className:"space-y-1",children:t.result.detailed_predictions.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between text-xs bg-gray-50 p-2 rounded",children:[(0,a.jsx)("span",{className:"font-medium",children:e.sign}),(0,a.jsxs)("span",{children:[(100*e.confidence).toFixed(1),"%"]})]},t))})]})]}):(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:(0,a.jsx)("p",{children:t.message||"No se detectaron se\xf1ales v\xe1lidas"})})})]}):null:(0,a.jsx)(n.Zp,{className:r,children:(0,a.jsx)(n.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Muestra tu mano para comenzar la traducci\xf3n"})]})})})}var m=s(7168),x=s(6645),g=s(3999);let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(x.bL,{className:(0,g.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:(0,a.jsx)(x.zi,{className:(0,g.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});f.displayName=x.bL.displayName;var p=s(6517),v=s(4449),b=s(136),j=s(8979),N=s(5690),w=s(381);function y(e){let{isTranslating:t,isCameraActive:s,isBackendConnected:r,onToggleTranslation:l,onToggleCamera:o,onSettings:d,translationCount:u=0,className:h}=e;return(0,a.jsxs)(n.Zp,{className:h,children:[(0,a.jsx)(n.aR,{children:(0,a.jsxs)(n.ZB,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Control"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(c.E,{variant:r?"default":"destructive",className:"text-xs",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{className:"h-3 w-3 mr-1"}),"Conectado"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{className:"h-3 w-3 mr-1"}),"Desconectado"]})})})]})}),(0,a.jsxs)(n.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(m.$,{onClick:o,variant:s?"default":"outline",className:"w-full",disabled:!r,children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Desactivar"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.A,{className:"h-4 w-4 mr-2"}),"Activar C\xe1mara"]})}),(0,a.jsx)(m.$,{onClick:l,variant:t?"destructive":"default",className:"w-full",disabled:!s||!r,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Parar"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Iniciar"]})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"Traducci\xf3n autom\xe1tica"}),(0,a.jsx)(f,{checked:t,onCheckedChange:l,disabled:!s||!r})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"Traducciones realizadas"}),(0,a.jsx)(c.E,{variant:"outline",children:u})]})]}),(0,a.jsx)("div",{className:"pt-2 border-t",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(s?"bg-green-500":"bg-gray-300")}),"C\xe1mara"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(r?"bg-green-500":"bg-red-500")}),"Backend"]})]})}),d&&(0,a.jsxs)(m.$,{onClick:d,variant:"ghost",size:"sm",className:"w-full",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Configuraci\xf3n"]})]})]})}function T(e){let{cameraView:t,translationResult:s,controlPanel:r,className:n}=e;return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 ".concat(n),children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Traductor de Lenguaje de Se\xf1as"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Muestra tu mano para traducir letras del alfabeto de se\xf1as"})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-1",children:t})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-1",children:r}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-1",children:s})]})]})})})}var k=s(8693);s(5695),s(1089);let C={ACCEPT:.6},A={autoReconnect:!0,maxReconnectAttempts:10,backoffInitialMs:500,backoffFactor:2,backoffMaxMs:5e3,heartbeatIntervalMs:2e4,heartbeatTimeoutMs:5e3,log:!1};class R{getStatus(){return this.status}getSessionId(){return this.sessionId}on(e,t){let s=this.listeners[e]||[];return s.push(t),this.listeners[e]=s,()=>{let s=this.listeners[e]||[];this.listeners[e]=s.filter(e=>e!==t)}}emit(e){for(var t,s=arguments.length,a=Array(s>1?s-1:0),r=1;r<s;r++)a[r-1]=arguments[r];null===(t=this.listeners[e])||void 0===t||t.forEach(e=>{try{e(...a)}catch(e){this.opts.log&&console.error("[Realtime] listener error",e)}})}connect(){if(this.ws&&("open"===this.status||"connecting"===this.status)){this.opts.log&&console.log("[RealtimeWS] Ya conectado/conectando, estado:",this.status);return}this.status=this.reconnectAttempts>0?"reconnecting":"connecting",this.opts.log&&console.log("[RealtimeWS] Intentando conectar a:",this.url);try{this.ws=new WebSocket(this.url)}catch(e){this.opts.log&&console.error("[RealtimeWS] Error creando WebSocket:",e),this.status="error",this.emit("error",e);return}this.ws.onopen=()=>{this.opts.log&&console.log("[RealtimeWS] Conexi\xf3n abierta"),this.status="open",this.emit("open"),this.reconnectAttempts=0,this.startHeartbeat()},this.ws.onmessage=e=>{let t;this.opts.log&&console.log("[RealtimeWS] Mensaje recibido:",e.data);try{t=JSON.parse(e.data)}catch(e){return}switch(this.emit("raw",t),t.type){case"session":this.sessionId=t.session_id,this.emit("session",this.sessionId);break;case"prediction":{var s,a,r;let e={letter:(s=t).letter||"",confidence:null!==(a=s.confidence)&&void 0!==a?a:0,processingTimeMs:null!==(r=s.processing_time_ms)&&void 0!==r?r:0,hasLandmarks:!!s.landmarks_detected,raw:s};this.emit("prediction",e);break}case"pong":this.clearHeartbeatTimeout();break;case"error":this.emit("error",t.error)}},this.ws.onerror=e=>{this.opts.log&&console.error("[RealtimeWS] Error en WebSocket:",e),this.emit("error",e)},this.ws.onclose=e=>{this.opts.log&&console.log("[RealtimeWS] Conexi\xf3n cerrada:",e.code,e.reason),this.stopHeartbeat(),this.emit("close",e),"closing"!==this.status&&(this.status="error",this.opts.autoReconnect&&this.reconnectAttempts<this.opts.maxReconnectAttempts&&this.scheduleReconnect())}}scheduleReconnect(){this.reconnectAttempts+=1;let e=Math.min(this.opts.backoffInitialMs*Math.pow(this.opts.backoffFactor,this.reconnectAttempts-1),this.opts.backoffMaxMs);this.emit("reconnect",this.reconnectAttempts,e),setTimeout(()=>this.connect(),e)}startHeartbeat(){this.opts.heartbeatIntervalMs<=0||(this.stopHeartbeat(),this.heartbeatTimer=setInterval(()=>{this.ws&&"open"===this.status&&(this.sendPing(),this.setHeartbeatTimeout())},this.opts.heartbeatIntervalMs))}stopHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=null,this.clearHeartbeatTimeout()}setHeartbeatTimeout(){this.clearHeartbeatTimeout(),this.heartbeatTimeout=setTimeout(()=>{this.opts.log&&console.warn("[Realtime] Heartbeat timeout - forcing reconnect"),this.forceReconnect()},this.opts.heartbeatTimeoutMs)}clearHeartbeatTimeout(){this.heartbeatTimeout&&clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=null}forceReconnect(){if(this.ws)try{this.ws.close()}catch(e){}}sendFrame(e){if(!this.ws||"open"!==this.status){this.opts.log&&console.warn("[RealtimeWS] No se puede enviar frame, ws:",!!this.ws,"status:",this.status);return}let t={type:"frame",image:e,timestamp:Date.now()};this.opts.log&&console.log("[RealtimeWS] Enviando frame, tama\xf1o:",e.length),this.ws.send(JSON.stringify(t))}sendPing(){if(!this.ws||"open"!==this.status)return;let e={type:"ping",timestamp:Date.now()};this.ws.send(JSON.stringify(e))}close(){if(this.status="closing",this.stopHeartbeat(),this.ws)try{this.ws.close()}catch(e){}this.ws=null,this.status="idle"}constructor(e={}){this.ws=null,this.status="idle",this.listeners={},this.reconnectAttempts=0,this.heartbeatTimer=null,this.heartbeatTimeout=null,this.sessionId=null;let t="http://localhost:8000",s=e.url||(t.startsWith("https")?t.replace("https","wss"):t.replace("http","ws"));this.url=s.replace(/\/$/,"")+"/api/v1/ml/predict",this.opts={...A,...e},this.opts.log&&console.log("[RealtimeWS] URL construida:",this.url)}}class S{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(this.baseURL).concat(e),a={...t,headers:{...t.headers}},r=new AbortController,n=setTimeout(()=>r.abort(),this.timeout);try{let e=await fetch(s,{...a,signal:r.signal});if(clearTimeout(n),!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||"HTTP ".concat(e.status))}return await e.json()}catch(e){if(clearTimeout(n),e instanceof Error){if("AbortError"===e.name)throw Error("Request timeout");throw e}throw Error("Unknown error occurred")}}async post(e,t){return this.request(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async get(e){return this.request(e,{method:"GET"})}async postFormData(e,t){return this.request(e,{method:"POST",body:t})}constructor(){this.baseURL="http://localhost:8000",this.timeout=1e4}}class E{async translateFrame(e){let t=new FormData;t.append("file",e);try{return await this.client.postFormData("/api/v1/ml/predict/upload",t)}catch(e){throw console.error("Translation error:",e),Error(e instanceof Error?e.message:"Translation failed")}}async healthCheck(){try{return await this.client.get("/api/v1/ml/health")}catch(e){throw Error("Health check failed")}}async getModelInfo(){try{return await this.client.get("/api/v1/ml/model/info")}catch(e){throw Error("Failed to get model info")}}constructor(){this.client=new S}}let M=new E,I=(0,s(2085).F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function _(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,g.cn)(I({variant:s}),t),...r})}function F(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,g.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}var W=s(5339);function P(){let e=(0,r.useRef)(null),[t,s]=(0,r.useState)(0),[n,i]=(0,r.useState)(!1),{isTranslating:c,currentPrediction:o,confidence:d,lastTranslation:u,startRealtimeTranslation:m,stopRealtimeTranslation:x}=function(){let[e,t]=(0,r.useState)(!1),[s,a]=(0,r.useState)("prompt"),[n,i]=(0,r.useState)(!1),[l,c]=(0,r.useState)(""),o=(0,r.useRef)(null),d=(0,r.useRef)(null),[u,h]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),[g,f]=(0,r.useState)(0),[p,v]=(0,r.useState)(null),b=(0,r.useRef)(null),j=(0,r.useRef)(null),{status:N,lastPrediction:w,error:y,connect:T,disconnect:k,sendFrame:A}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.useRef)(null),[s,a]=(0,r.useState)("idle"),[n,i]=(0,r.useState)(null),[l,c]=(0,r.useState)(null),[o,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(null);t.current||(t.current=new R({log:e.log}));let m=(0,r.useCallback)(()=>{var e;null===(e=t.current)||void 0===e||e.connect()},[]),x=(0,r.useCallback)(()=>{var e;null===(e=t.current)||void 0===e||e.close(),a("idle")},[]),g=(0,r.useCallback)(e=>{var s;null===(s=t.current)||void 0===s||s.sendFrame(e)},[]);return(0,r.useEffect)(()=>{let s=t.current,r=s.on("open",()=>{e.log&&console.log("[RT] open"),a("open"),d(null)}),n=s.on("close",()=>{e.log&&console.log("[RT] close"),a("idle")}),l=s.on("error",t=>{e.log&&console.error("[RT] error",t),d("string"==typeof t?t:"Realtime error"),a("error")}),o=s.on("session",t=>{e.log&&console.log("[RT] session",t),c(t)}),u=s.on("prediction",t=>{e.log&&console.log("[RT] prediction",t),i(t)}),x=s.on("reconnect",(t,s)=>{e.log&&console.warn("[RT] reconnect",{attempt:t,delayMs:s}),a("reconnecting"),h({attempt:t,delayMs:s})}),g=s.on("raw",t=>{e.log&&console.debug("[RT] raw",t)});return e.autoConnect&&m(),()=>{r(),n(),l(),o(),u(),x(),g()}},[]),{status:s,lastPrediction:n,sessionId:l,error:o,reconnectInfo:u,connect:m,disconnect:x,sendFrame:g}}({autoConnect:!1,log:!0});(0,r.useEffect)(()=>{y&&c(y)},[y]),(0,r.useEffect)(()=>{if(!w)return;console.log("[CAM] nueva predicci\xf3n",w);let e=w.letter||"",t=w.confidence||0;t>=C.ACCEPT&&e?x(e):e||x("?"),f(t),v({success:!0,method:"websocket_prediction",result:{text:e||"?",confidence:t,processing_time_ms:w.processingTimeMs||0,signs_detected:+!!w.hasLandmarks,detailed_predictions:[]}})},[w]),(0,r.useEffect)(()=>{t("undefined"!=typeof navigator&&"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices)},[]);let S=(0,r.useCallback)(async()=>{if(!e)return c("Camera not supported in this browser"),!1;try{i(!0),c("");let e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});return o.current&&(o.current.srcObject=e,d.current=e),a("granted"),!0}catch(e){return c(e.message||"Camera access failed"),a("denied"),!1}finally{i(!1)}},[e]),E=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=t||u;if(console.debug("[CAM] captureAndSendFrame llamado, isTranslating:",u,"forceTranslating:",t,"shouldTranslate:",s),!s){console.debug("[CAM] No traduciendo, saliendo");return}if(!(null==e?void 0:e.current)){console.debug("[CAM] Sin cameraViewRef.current, saliendo");return}try{var a,r;let t=(null===(a=(r=e.current).getVideoElement)||void 0===a?void 0:a.call(r))||o.current;if(!t){console.debug("[CAM] Sin videoElement, saliendo");return}if(t.readyState<2){console.debug("[CAM] Video no listo, readyState:",t.readyState);return}b.current||(b.current=document.createElement("canvas"));let s=b.current;s.width=t.videoWidth||640,s.height=t.videoHeight||480;let n=s.getContext("2d");if(!n){console.debug("[CAM] Sin contexto canvas, saliendo");return}n.drawImage(t,0,0,s.width,s.height);let i=s.toDataURL("image/jpeg",.8).split(",")[1];console.debug("[CAM] frame enviado len=",null==i?void 0:i.length),i&&A(i)}catch(e){console.error("[CAM] error capturando frame",e)}},[u,A]),M=(0,r.useCallback)(e=>{!u&&(console.log("[CAM] iniciar realtime, cameraViewRef:",!!(null==e?void 0:e.current)),T(),h(!0),x(""),f(0),j.current=setInterval(()=>{console.debug("[CAM] interval tick"),E(e,!0)},200),console.log("[CAM] interval iniciado con ID:",j.current))},[u,T,E]),I=(0,r.useCallback)(()=>{u&&(console.log("[CAM] detener realtime"),h(!1),j.current&&(clearInterval(j.current),j.current=null),k())},[u,k]);(0,r.useEffect)(()=>()=>{j.current&&clearInterval(j.current)},[]);let _=(0,r.useCallback)(()=>{d.current&&(d.current.getTracks().forEach(e=>e.stop()),d.current=null),o.current&&(o.current.srcObject=null),I(),a("prompt"),c("")},[I]),F=(0,r.useCallback)(()=>{if(!o.current)return Promise.resolve(null);let e=document.createElement("canvas"),t=e.getContext("2d");return t?(e.width=o.current.videoWidth,e.height=o.current.videoHeight,t.drawImage(o.current,0,0),new Promise(t=>{e.toBlob(e=>{e?t(new File([e],"frame.jpg",{type:"image/jpeg"})):t(null)},"image/jpeg",.8)})):Promise.resolve(null)},[]);return{videoRef:o,isSupported:e,permission:s,isInitializing:n,error:l,initialize:S,cleanup:_,captureFrame:F,isTranslating:u,currentPrediction:m,confidence:g,lastTranslation:p,startRealtimeTranslation:M,stopRealtimeTranslation:I,realtimeStatus:N}}(),{isConnected:g}=function(){let[e,t]=(0,r.useState)(!1),[s,a]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),l=(0,r.useRef)(null),c=(0,r.useCallback)(async()=>{try{a(!0),await M.healthCheck(),t(!0),i(new Date)}catch(e){t(!1)}finally{a(!1)}},[]);return(0,r.useEffect)(()=>(c(),l.current=setInterval(c,15e3),()=>{l.current&&clearInterval(l.current)}),[c]),{isConnected:e,isChecking:s,lastCheck:n,checkConnection:c}}(),[f,p]=(0,r.useState)(""),v=f||"",b=f||"",j=async()=>{console.log("[TRANSLATE] Toggle camera:",!n),i(!n),n&&c&&(console.log("[TRANSLATE] Deteniendo traducci\xf3n por c\xe1mara desactivada"),x())};return(0,a.jsxs)(k.e,{currentPage:"translate",children:[v&&(0,a.jsx)("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-40 w-full max-w-md px-4",children:(0,a.jsxs)(_,{className:"border-red-200 bg-red-50",children:[(0,a.jsx)(W.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)(F,{className:"text-red-800",children:b})]})}),(0,a.jsx)(k.K,{title:"Traductor de Lenguaje de Se\xf1as",subtitle:"Traduce se\xf1as en tiempo real usando inteligencia artificial"}),(0,a.jsx)("section",{className:"py-8 px-4",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsx)(T,{cameraView:(0,a.jsx)(l,{ref:e,isActive:n,onError:p}),controlPanel:(0,a.jsx)(y,{isTranslating:c,isCameraActive:n,isBackendConnected:g,onToggleTranslation:()=>{console.log("[TRANSLATE] Toggle translation, current isTranslating:",c),console.log("[TRANSLATE] cameraRef.current existe:",!!e.current),console.log("[TRANSLATE] isCameraActive:",n),c?x():(n||console.warn("[TRANSLATE] C\xe1mara no est\xe1 activa, la traducci\xf3n puede no funcionar"),console.log("[TRANSLATE] Iniciando traducci\xf3n, cameraRef.current:",!!e.current),m(e),s(e=>e+1))},onToggleCamera:j,translationCount:t}),translationResult:(0,a.jsx)(h,{result:u,isProcessing:c&&n,currentPrediction:o,confidence:d})})})})]})}},6739:(e,t,s)=>{Promise.resolve().then(s.bind(s,1745))},8145:(e,t,s)=>{"use strict";s.d(t,{E:()=>c});var a=s(5155);s(2115);var r=s(9708),n=s(2085),i=s(3999);let l=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:s,asChild:n=!1,...c}=e,o=n?r.DX:"span";return(0,a.jsx)(o,{"data-slot":"badge",className:(0,i.cn)(l({variant:s}),t),...c})}},8482:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>l,Zp:()=>n,aR:()=>i});var a=s(5155);s(2115);var r=s(3999);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...s})}},8693:(e,t,s)=>{"use strict";s.d(t,{e:()=>p,K:()=>v});var a=s(5155),r=s(2115),n=s(7168),i=s(6427),l=s(7340),c=s(6785),o=s(288),d=s(5690),u=s(6813),h=s(4783),m=s(4416),x=s(6874),g=s.n(x);let f=[{href:"/",label:"Inicio",icon:l.A,key:"home"},{href:"/practice",label:"Pr\xe1ctica",icon:c.A,key:"practice"},{href:"/game",label:"Juego",icon:o.A,key:"game"},{href:"/translate",label:"Traducir",icon:d.A,key:"translate"}];function p(e){let{children:t,currentPage:s="home"}=e,[l,c]=(0,r.useState)(!1),o=()=>c(!1);return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,a.jsx)("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-blue-600 focus:text-white focus:rounded-md focus:shadow-lg",children:"Saltar al contenido principal"}),(0,a.jsxs)("header",{className:"px-4 lg:px-6 h-16 flex items-center border-b bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/60 sticky top-0 z-50",children:[(0,a.jsxs)(g(),{href:"/",className:"flex items-center justify-center",children:[(0,a.jsx)(u.A,{className:"h-8 w-8 text-blue-600"}),(0,a.jsx)("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"ComSigns"})]}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>c(!0),className:"ml-4","aria-label":"Abrir men\xfa de navegaci\xf3n principal","aria-expanded":l,"aria-controls":"sidebar-nav",children:(0,a.jsx)(h.A,{className:"h-5 w-5"})}),(0,a.jsxs)("nav",{className:"ml-auto hidden md:flex gap-4 sm:gap-6 items-center",children:[f.map(e=>(0,a.jsx)(g(),{href:e.href,className:"text-sm font-medium transition-colors ".concat(s===e.key?"text-blue-600 border-b-2 border-blue-600":"hover:text-blue-600"),children:e.label},e.key)),(0,a.jsx)("div",{className:"ml-4",children:(0,a.jsx)(i.Nr,{})})]}),(0,a.jsx)("div",{className:"ml-auto md:hidden",children:(0,a.jsx)(i.Nr,{})})]}),l&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50",onClick:o}),(0,a.jsxs)("aside",{id:"sidebar-nav",className:"relative w-64 bg-white shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"h-6 w-6 text-blue-600"}),(0,a.jsx)("span",{className:"ml-2 text-lg font-bold",children:"ComSigns"})]}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:o,"aria-label":"Cerrar men\xfa",children:(0,a.jsx)(m.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("nav",{className:"p-4 space-y-2",children:f.map(e=>{let t=e.icon;return(0,a.jsxs)(g(),{href:e.href,className:"flex items-center gap-3 px-3 py-2 rounded-md transition-colors ".concat(s===e.key?"bg-blue-50 text-blue-600":"hover:bg-gray-100"),onClick:o,children:[(0,a.jsx)(t,{className:"h-5 w-5"}),e.label]},e.key)})})]})]}),(0,a.jsx)("main",{id:"main-content",className:"flex-1",children:t})]})}function v(e){let{title:t,subtitle:s,children:r,background:n="gradient",className:i=""}=e;return(0,a.jsx)("section",{className:"py-12 px-4 ".concat({gradient:"bg-gradient-to-b from-blue-50 to-white",solid:"bg-blue-50",custom:""}[n]," ").concat(i),children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:t}),s&&(0,a.jsx)("p",{className:"text-xl text-gray-600 mb-8",children:s}),r]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[211,647,17,427,441,684,358],()=>t(6739)),_N_E=e.O()}]);